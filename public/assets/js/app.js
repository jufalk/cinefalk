
const dados = {
  "noticias": [
    {
      "id": 1,
      "titulo": "Interestelar: Uma Viagem Além das Estrelas",
      "descricao": "Filme explora viagens interplanetárias em busca da sobrevivência humana.",
      "conteudo": "Interestelar, dirigido por Christopher Nolan, é uma obra-prima da ficção científica que aborda temas como viagens interestelares, teoria da relatividade e amor transcendente. O enredo acompanha um grupo de astronautas que viajam através de um buraco de minhoca em busca de um novo lar para a humanidade.",
      "categoria": "Ficção Científica",
      "autor": "Equipe CineNews",
      "destaque": true,
      "data": "2025-04-20",
      "imagem_pincipal": "assets/img/interestelar.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/interestelar1.jpg",
          "descricao": "Cena no planeta de gelo"
        },
        {
          "id": 2,
          "src": "assets/img/interestelar2.jpg",
          "descricao": "Nave Endurance viajando pelo espaço"
        },
        {
          "id": 3,
          "src": "assets/img/interestelar3.jpg",
          "descricao": "Protagonistas em missão no planeta aquático"
        }
      ]
    },
    {
      "id": 2,
      "titulo": "Uma Mente Brilhante: A História de John Nash",
      "descricao": "Drama biográfico sobre o gênio matemático vencedor do Nobel.",
      "conteudo": "Uma Mente Brilhante retrata a vida de John Nash, um matemático brilhante que lida com a esquizofrenia ao longo da vida. O filme explora sua luta pessoal e seu impacto duradouro no mundo da matemática e da economia.",
      "categoria": "Drama Biográfico",
      "autor": "Equipe CineNews",
      "destaque": false,
      "data": "2025-04-21",
      "imagem_pincipal": "assets/img/uma_mente_brilhante.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/uma_mente_brilhante1.jpg",
          "descricao": "John Nash em sala de aula"
        },
        {
          "id": 2,
          "src": "assets/img/uma_mente_brilhante2.jpg",
          "descricao": "Cena no refeitório da universidade"
        },
        {
          "id": 3,
          "src": "assets/img/uma_mente_brilhante3.jpg",
          "descricao": "John Nash recebendo o Prêmio Nobel"
        }
      ]
    },
    {
      "id": 3,
      "titulo": "O Jogo da Imitação: A Vida de Alan Turing",
      "descricao": "História de Alan Turing, o matemático que ajudou a decifrar códigos nazistas.",
      "conteudo": "O Jogo da Imitação conta a história real de Alan Turing, um gênio da computação que decifrou mensagens secretas durante a Segunda Guerra Mundial, mudando o rumo da história. O filme também aborda os preconceitos da época contra sua orientação sexual.",
      "categoria": "Drama Histórico",
      "autor": "Equipe CineNews",
      "destaque": true,
      "data": "2025-04-22",
      "imagem_pincipal": "assets/img/jogo_imitacao.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/jogo_imitacao1.jpg",
          "descricao": "Alan Turing e sua equipe na construção da máquina"
        },
        {
          "id": 2,
          "src": "assets/img/jogo_imitacao2.jpg",
          "descricao": "Cena da decodificação de mensagens"
        },
        {
          "id": 3,
          "src": "assets/img/jogo_imitacao3.jpg",
          "descricao": "Turing enfrentando julgamento"
        }
      ]
    },
    {
      "id": 4,
      "titulo": "Piratas do Vale do Silício: O Início da Era Digital",
      "descricao": "Filme narra a rivalidade entre Steve Jobs e Bill Gates.",
      "conteudo": "Piratas do Vale do Silício explora o surgimento das gigantes tecnológicas Apple e Microsoft, focando na juventude de Steve Jobs e Bill Gates e suas jornadas de ambição e inovação no mundo da computação.",
      "categoria": "Drama Tecnológico",
      "autor": "Equipe CineNews",
      "destaque": true,
      "data": "2025-04-23",
      "imagem_pincipal": "assets/img/piratas_silicio.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/piratas_silicio1.jpg",
          "descricao": "Steve Jobs apresentando o Macintosh"
        },
        {
          "id": 2,
          "src": "assets/img/piratas_silicio2.jpg",
          "descricao": "Bill Gates negociando com IBM"
        },
        {
          "id": 3,
          "src": "assets/img/piratas_silicio3.jpg",
          "descricao": "Apple e Microsoft nos anos 80"
        }
      ]
    },
    {
      "id": 5,
      "titulo": "Clube da Luta: Um Clássico Subversivo",
      "descricao": "Um homem desiludido forma um clube secreto de lutas.",
      "conteudo": "Clube da Luta, baseado no livro de Chuck Palahniuk, aborda o consumismo, identidade e alienação. O protagonista, entediado com sua vida comum, encontra em Tyler Durden uma nova filosofia de vida baseada na rebelião contra o sistema.",
      "categoria": "Drama Psicológico",
      "autor": "Equipe CineNews",
      "destaque": false,
      "data": "2025-04-24",
      "imagem_pincipal": "assets/img/clube_luta.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/clube_luta1.jpg",
          "descricao": "Cena de luta no porão"
        },
        {
          "id": 2,
          "src": "assets/img/clube_luta2.jpg",
          "descricao": "Tyler Durden discursando"
        },
        {
          "id": 3,
          "src": "assets/img/clube_luta3.jpg",
          "descricao": "Explosão final"
        }
      ]
    },
    {
      "id": 6,
      "titulo": "O Grande Truque: Rivalidade Mágica no Século XIX",
      "descricao": "Dois mágicos rivais levam sua obsessão a extremos perigosos.",
      "conteudo": "O Grande Truque é um thriller que explora a rivalidade entre dois ilusionistas, mostrando como a obsessão pela superioridade artística pode consumir e destruir vidas. Dirigido por Christopher Nolan, o filme é cheio de reviravoltas.",
      "categoria": "Suspense",
      "autor": "Equipe CineNews",
      "destaque": true,
      "data": "2025-04-25",
      "imagem_pincipal": "assets/img/grande_truque.jpg",
      "imagens_complementares": [
        {
          "id": 1,
          "src": "assets/img/grande_truque1.jpg",
          "descricao": "Duelo entre mágicos"
        },
        {
          "id": 2,
          "src": "assets/img/grande_truque2.jpg",
          "descricao": "Cena do truque com a caixa d'água"
        },
        {
          "id": 3,
          "src": "assets/img/grande_truque3.jpg",
          "descricao": "Teatro cheio para apresentação final"
        }
      ]
    }
  ]
};


function carregarDestaques() {
  const destaques = dados.noticias.filter(n => n.destaque);
  const carouselInner = document.querySelector('#destaques-carousel-container');

  if (!carouselInner) return;

  carouselInner.innerHTML = '';

  destaques.forEach((noticia, index) => {
    const ativo = index === 0 ? 'active' : '';
    const item = `
      <div class="carousel-item ${ativo}">
        <img src="${noticia.imagem_pincipal}" class="d-block w-100" alt="${noticia.titulo}">
        <div class="carousel-caption d-none d-md-block">
          <h5>${noticia.titulo}</h5>
          <p>${noticia.descricao}</p>
          <a href="detalhe.html?id=${noticia.id}" class="btn btn-light btn-sm mt-2">Ver mais</a>
        </div>
      </div>
    `;
    carouselInner.innerHTML += item;
  });
}

function carregarCardsNoticias() {
  const container = document.querySelector('#lista-itens');

  if (!container) return;

  container.innerHTML = '';

  dados.noticias.forEach(noticia => {
    const card = `
      <div class="col-md-4 mb-4">
        <div class="card h-100" onclick="window.location.href='detalhe.html?id=${noticia.id}'">
          <img src="${noticia.imagem_pincipal}" class="card-img-top" alt="${noticia.titulo}">
          <div class="card-body">
            <h5 class="card-title">${noticia.titulo}</h5>
            <p class="card-text">${noticia.descricao}</p>
          </div>
          <div class="card-footer text-muted">${noticia.data}</div>
        </div>
      </div>
    `;
    container.innerHTML += card;
  });
}


function carregarDetalhes() {
  const id = parseInt(getIdUrl());
  const item = dados.noticias.find(n => n.id === id);

  if (!item) {
    document.getElementById('conteudo-noticia').innerHTML = '<p>Item não encontrado.</p>';
    return;
  }

  
  const infoHTML = `
    <h4>${item.titulo}</h4>
    <p><strong>Categoria:</strong> ${item.categoria}</p>
    <p><strong>Data:</strong> ${item.data}</p>
    <p><strong>Autor:</strong> ${item.autor}</p>
    <img src="${item.imagem_pincipal}" alt="${item.titulo}" class="img-fluid my-3 rounded"/>
    <p>${item.conteudo}</p>
  `;
  document.getElementById('conteudo-noticia').innerHTML = infoHTML;

  const galeria = document.getElementById('galeria-fotos');
  galeria.innerHTML = item.imagens_complementares.map(foto => `
    <div class="col-md-4">
      <div class="card h-100">
        <img src="${foto.src}" class="card-img-top" alt="${foto.descricao}">
        <div class="card-body">
          <p class="card-text">${foto.descricao}</p>
        </div>
      </div>
    </div>
  `).join('');
}


function getIdUrl() {
  const params = new URLSearchParams(window.location.search);
  return params.get('id');
}

document.addEventListener("DOMContentLoaded", () => {
  if (document.getElementById("destaques-carousel-container")) {
    carregarDestaques();
    carregarCardsNoticias();
  }


  if (document.getElementById("conteudo-noticia")) {
    carregarDetalhes();
  }
})
mapboxgl.accessToken = 'SUA_CHAVE_MAPBOX_AQUI';

const map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v12',
  center: [-46.633308, -23.55052], // Coordenadas iniciais (São Paulo)
  zoom: 2
});

// Exemplo: locais de gravação de filmes
const locaisGravacao = [
  {
    titulo: "Interestelar",
    coordenadas: [-104.9847, 39.7392], // Denver, Colorado
    descricao: "Gravado em Alberta (Canadá) e Islândia"
  },
  {
    titulo: "O Jogo da Imitação",
    coordenadas: [-0.1276, 51.5074], // Londres, Reino Unido
    descricao: "Gravado em Londres e Bletchley Park"
  }
];

locaisGravacao.forEach((filme) => {
  const popup = new mapboxgl.Popup({ offset: 25 }).setText(`${filme.titulo}: ${filme.descricao}`);
  new mapboxgl.Marker().setLngLat(filme.coordenadas).setPopup(popup).addTo(map);
});
fetch("http://localhost:3000/noticias", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
        titulo: "Novo Filme Espacial",
        descricao: "Filme aborda exploração intergaláctica.",
        categoria: "Ficção Científica",
        autor: "Equipe CineNews",
        data: "2025-05-15"
    })
})
.then(response => response.json())
.then(data => console.log("Registro criado:", data))
.catch(error => console.error("Erro ao criar notícia:", error));
fetch("http://localhost:3000/noticias", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
        titulo: "Novo Filme Espacial",
        descricao: "Filme aborda exploração intergaláctica.",
        categoria: "Ficção Científica",
        autor: "Equipe CineNews",
        data: "2025-05-15"
    })
})
.then(response => response.json())
.then(data => console.log("Registro criado:", data))
.catch(error => console.error("Erro ao criar notícia:", error));

fetch("http://localhost:3000/noticias/1", {
    method: "PATCH",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ titulo: "Interestelar: Uma Nova Jornada" })
})
.then(response => response.json())
.then(data => console.log("Notícia atualizada:", data))
.catch(error => console.error("Erro ao atualizar notícia:", error));

fetch("http://localhost:3000/noticias/2", {
    method: "DELETE"
})
.then(() => console.log("Notícia excluída"))
.catch(error => console.error("Erro ao excluir notícia:", error));
document.getElementById("formulario").addEventListener("submit", function(event) {
    event.preventDefault(); // Impede o recarregamento da página

    const titulo = document.getElementById("titulo").value;
    const descricao = document.getElementById("descricao").value;
    const categoria = document.getElementById("categoria").value;
    const autor = document.getElementById("autor").value;

    const novaNoticia = {
        titulo: titulo,
        descricao: descricao,
        categoria: categoria,
        autor: autor,
        data: new Date().toISOString().split("T")[0] // Data automática
    };

    fetch("http://localhost:3000/noticias", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(novaNoticia)
    })
    .then(response => response.json())
    .then(data => {
        console.log("Notícia cadastrada com sucesso!", data);
        alert("Notícia cadastrada com sucesso!");
    })
    .catch(error => console.error("Erro ao cadastrar notícia:", error));
});
;